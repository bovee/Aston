import re

abn = {'-': {0.000548: 100},
       'C': {12: 100, 13.00335: 1.08},
       'H': {1.00782504: 100, 2.01410178: 0.0115},
       'O': {15.99491461956: 100, 16.99913170: 0.038, 17.9991610: 0.205},
       'N': {14.0030740048: 100, 15.0001088982: 0.369},
       'P': {30.97376163: 100},
       'F': {18.99840322: 100},
       'I': {126.904473: 100},
       'Si': {27.9769265325: 100, 28.976494700: 5.0778, 29.97377017: 3.3473},
       'S': {31.97207100: 100, 32.97145876: 0.80, 33.96786690: 4.52},
       'Cl': {34.96885268: 100, 36.96590259: 31.96},
       'Br': {78.9183371: 100, 80.9162906: 97.28}
       }


def mono_mass(formula):
    mass = 0
    for atom, count in re.findall('([A-Z][a-z]*)(\d*)', formula):
        if count == '':
            count = 1
        else:
            count = float(count)
        #TODO: assumption is lowest mass isotope is most abundant
        mass += count * min(abn[atom].keys())
    return mass


test = [(354.134499255997, 633504), (355.136551393827, 147822), \
        (356.138919219861, 21550), (357.140369476609, 2544)]
test_form = 'C20H19NO5'
